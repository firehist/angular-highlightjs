/*! angular-highlightjs
version: 0.1.3
build date: 2013-10-13
author: Robin Fan
https://github.com/pc035860/angular-highlightjs.git */
angular.module("hljs",[]).factory("$hljsCache",["$cacheFactory",function(a){return a("$hljsCache")}]).controller("HljsCtrl",["$hljsCache",function(a){var b=this,c=null,d=null,e=null,f=null;b.init=function(a){c=a},b.setLanguage=function(a){d=a,e&&b.highlight(e)},b.highlightCallback=function(a){f=a},b.highlight=function(g){if(c){var h,i;e=g,d?(i=b._cacheKey(d,e),h=a.get(i),h||(h=hljs.highlight(d,e,!0),a.put(i,h))):(i=b._cacheKey(e),h=a.get(i),h||(h=hljs.highlightAuto(e),a.put(i,h))),c.html(h.value),null!==f&&angular.isFunction(f)&&f()}},b.clear=function(){c&&(e=null,c.text(""))},b.release=function(){c=null},b._cacheKey=function(){var a=Array.prototype.slice.call(arguments),b="!angular-highlightjs!";return a.join(b)}}]).directive("hljs",[function(){return{restrict:"EA",controller:"HljsCtrl",compile:function(a){var b=a[0].innerHTML.replace(/^\r\n|\r|\n/,"");return a.html("<pre><code></code></pre>"),function(a,c,d,e){e.init(c.find("code")),d.onhighlight&&e.highlightCallback(function(){a.$eval(d.onhighlight)}),b&&e.highlight(b),a.$on("$destroy",function(){e.release()})}}}}]).directive("language",[function(){return{require:"hljs",restrict:"A",link:function(a,b,c,d){c.$observe("language",function(a){angular.isDefined(a)&&d.setLanguage(a)})}}}]).directive("source",["$compile",function(a){return{require:"hljs",restrict:"A",link:function(b,c,d,e){b.$watch(d.source,function(d){d?(e.highlight(d),a(c.contents())(b)):e.clear()})}}}]).directive("include",["$http","$templateCache","$q","$compile",function(a,b,c,d){return{require:"hljs",restrict:"A",compile:function(e,f){var g=f.include;return function(e,f,h,i){var j=0;e.$watch(g,function(g){var h=++j;if(g&&angular.isString(g)){var k,l;k=b.get(g),k||(l=c.defer(),a.get(g,{cache:b}).success(function(a){h===j&&l.resolve(a)}).error(function(){h===j&&i.clear(),l.resolve()}),k=l.promise),c.when(k).then(function(a){a&&(angular.isArray(a)?a=a[1]:angular.isObject(a)&&(a=a.data),a=a.replace(/^\r\n|\r|\n/,""),i.highlight(a),d(f.contents())(e))})}else i.clear()})}}}}]);